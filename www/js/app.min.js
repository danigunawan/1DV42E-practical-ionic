"use strict";var BookingSystem=angular.module("BookingSystem",["ionic","BookingSystem.controllers","BookingSystem.furnituring","BookingSystem.furnituringServices","BookingSystem.meals","BookingSystem.mealsServices","BookingSystem.mealPropertiesServices","BookingSystem.resources","BookingSystem.resourcesServices","BookingSystem.customers","BookingSystem.customersServices","BookingSystem.bookingTypes","BookingSystem.bookingTypesServices","BookingSystem.imageResizeServices","ngMaterial","ngResource"]);BookingSystem.run(["$ionicPlatform",function(e){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]),BookingSystem.constant("API_URL","http://bokning.vvfors.se/api/"),BookingSystem.constant("API_IMG_PATH_URL","http://bokning.vvfors.se/"),BookingSystem.constant("UPLOAD_IMG_MAX_WIDTH","400"),BookingSystem.constant("UPLOAD_IMG_MAX_HEIGHT","400"),BookingSystem.constant("DEFAULT_MAP_ZOOM",5),BookingSystem.constant("DEFAULT_LATITUDE",59.2792),BookingSystem.constant("DEFAULT_LONGITUDE",15.2361),BookingSystem.constant("MODAL_ANIMATION","slide-in-up"),BookingSystem.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"/app","abstract":!0,templateUrl:"templates/menu.html",controller:"AppCtrl"}).state("app.start",{url:"/start",views:{menuContent:{templateUrl:"templates/start.html"}}}).state("app.furnituring-list",{url:"/furnituring-list",views:{menuContent:{templateUrl:"templates/furnituring/furnituring-list.html",controller:"FurnituringListCtrl"}}}).state("app.furnituring-details",{url:"/furnituring-details/:furnituringId",views:{menuContent:{templateUrl:"templates/furnituring/furnituring-details.html",controller:"FurnituringDetailsCtrl"}}}).state("app.furnituring-create",{url:"/furnituring-create",views:{menuContent:{templateUrl:"templates/furnituring/furnituring-create.html",controller:"FurnituringCreateCtrl"}}}).state("app.meals-list",{url:"/meals-list",views:{menuContent:{templateUrl:"templates/meals/meals-list.html",controller:"MealsListCtrl"}}}).state("app.meal-details",{url:"/meal-details/:mealId",views:{menuContent:{templateUrl:"templates/meals/meal-details.html",controller:"MealDetailsCtrl"}}}).state("app.meal-create",{url:"/meal-create",views:{menuContent:{templateUrl:"templates/meals/meal-create.html",controller:"MealCreateCtrl"}}}).state("app.resources-list",{url:"/resources-list",views:{menuContent:{templateUrl:"templates/resources/resources-list.html",controller:"ResourcesListCtrl"}}}).state("app.resource-details",{url:"/resource-details/:resourceId",views:{menuContent:{templateUrl:"templates/resources/resource-details.html",controller:"ResourceDetailsCtrl"}}}).state("app.resource-create",{url:"/resource-create",views:{menuContent:{templateUrl:"templates/resources/resource-create.html",controller:"ResourceCreateCtrl"}}}).state("app.customers-list",{url:"/customers-list",views:{menuContent:{templateUrl:"templates/customers/customers-list.html",controller:"CustomersListCtrl"}}}).state("app.customer-details",{url:"/customer-details/:customerId",views:{menuContent:{templateUrl:"templates/customers/customer-details.html",controller:"CustomerDetailsCtrl"}}}).state("app.customer-create",{url:"/customer-create",views:{menuContent:{templateUrl:"templates/customers/customer-create.html",controller:"CustomerCreateCtrl"}}}).state("app.bookingtypes-list",{url:"/bookingtypes-list",views:{menuContent:{templateUrl:"templates/bookingtypes/bookingtypes-list.html",controller:"BookingTypesListCtrl"}}}).state("app.bookingtype-details",{url:"/bookingtype-details/:bookingTypeId",views:{menuContent:{templateUrl:"templates/bookingtypes/bookingtype-details.html",controller:"BookingTypeDetailsCtrl"}}}).state("app.bookingtype-create",{url:"/bookingtype-create",views:{menuContent:{templateUrl:"templates/bookingtypes/bookingtype-create.html",controller:"BookingTypeCreateCtrl"}}}),t.otherwise("/app/start")}]),angular.module("BookingSystem.furnituringServices",["ngResource"]).factory("Furnituring",["$resource","API_URL",function(e,t){return e(t+"Furnituring/:furnituringId",{furnituringId:"@furnituringId"})}]).factory("LocationFurnituring",["$resource","API_URL",function(e,t){return e(t+"LocationFurnituring/:locationId",{locationId:"@locationId"},{remove:{url:t+"LocationFurnituring/:locationId/:furnituringId",id:"@id",method:"DELETE",isArray:!1,params:{locationId:"@locationId",furnituringId:"@furnituringId"}},removeForLocation:{url:t+"LocationFurnituring/:locationId",id:"@id",method:"DELETE",isArray:!1,params:{locationId:"@locationId"}},queryForLocation:{url:t+"LocationFurnituring/location/:locationId",id:"@id",method:"GET",isArray:!0,params:{locationId:"@locationId"}},saveForLocation:{url:t+"LocationFurnituring/location",id:"@id",method:"POST",isArray:!0}})}]),angular.module("BookingSystem.controllers",[]).controller("AppCtrl",["$scope","$ionicModal","$timeout",function(e,t,r){e.loginData={},t.fromTemplateUrl("templates/login.html",{scope:e}).then(function(t){e.modal=t}),e.closeLogin=function(){e.modal.hide()},e.login=function(){e.modal.show()},e.doLogin=function(){console.log("Doing login",e.loginData),r(function(){e.closeLogin()},1e3)}}]).controller("PlaylistsCtrl",["$scope",function(e){e.playlists=[{title:"Reggae",id:1},{title:"Chill",id:2},{title:"Dubstep",id:3},{title:"Indie",id:4},{title:"Rap",id:5},{title:"Cowbell",id:6}]}]).controller("PlaylistCtrl",["$scope","$stateParams",function(e,t){}]),angular.module("BookingSystem.furnituring",[]).controller("FurnituringListCtrl",["$rootScope","$scope","$state","Furnituring",function(e,t,r,s){var o=function(){var r=s.query();r.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Möbleringar kunde inte hämtas, var god försök igen."}}),t.furniturings=r};t.$on("$ionicView.enter",function(e,t){o()})}]).controller("FurnituringDetailsCtrl",["$rootScope","$scope","$stateParams","MODAL_ANIMATION","$state","$ionicModal","Furnituring",function(e,t,r,s,o,a,n){var i="templates/modals/furnituring-delete.html";t.editMode=!1,t.furnituringBackup={};var u=function(){a.fromTemplateUrl(i,{scope:t,animation:s}).then(function(e){t.modal=e}),t.$on("$destroy",function(){t.modal.remove()})},l=function(){var s=n.get({furnituringId:r.furnituringId});s.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Möblering kunde inte hämtas, var god försök igen."}}),t.furnituring=s};t.startEditMode=function(){var e=this;e.isEditMode=!0,e.furnituringBackup=angular.copy(e.furnituring)},t.endEditMode=function(){var e=this;e.isEditMode=!1},t.abortEditMode=function(){var e=this;e.isEditMode=!1,e.furnituring=e.furnituringBackup},t.saveFurnituring=function(){var t=this;n.save({FurnituringId:r.furnituringId,Name:t.furnituring.Name}).$promise.then(function(r){t.endEditMode(),e.FlashMessage={type:"success",message:'Möbleringen "'+t.furnituring.Name+'" sparades med ett lyckat resultat'}})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en möblering som heter "'+t.furnituring.Name+'". Två möbleringar kan inte heta lika.'}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när möbleringen skulle sparas"}),404===r.status&&(e.FlashMessage={type:"error",message:'Möbleringen "'+t.furnituring.Name+'" existerar inte längre. Hann kanske någon radera den?'},history.back())})},t.deleteFurnituring=function(){n["delete"]({furnituringId:r.furnituringId}).$promise.then(function(r){e.FlashMessage={type:"success",message:'Möbleringen "'+t.furnituring.Name+'" raderades med ett lyckat resultat'},history.back()})["catch"](function(r){400===r.status&&"undefined"!==r.data.Message&&"Foreign key references exists"===r.data.Message?e.FlashMessage={type:"error",message:"Möbleringen kan inte raderas eftersom det finns en lokalbokning eller en lokalmöblering som refererar till möbleringen"}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när möbleringen skulle tas bort"}),404===r.status&&(e.FlashMessage={type:"error",message:'Möbleringen "'+t.furnituring.Name+'" existerar inte längre. Hann kanske någon radera den?'}),history.back()})},u(),l()}]).controller("FurnituringCreateCtrl",["$rootScope","$stateParams","$scope","$state","Furnituring",function(e,t,r,s,o){r.furnituring={},r.saveFurnituring=function(){var t=this;o.save({FurnituringId:0,Name:t.furnituring.Name}).$promise.then(function(r){e.FlashMessage={type:"success",message:'Möbleringen "'+t.furnituring.Name+'" skapades med ett lyckat resultat'},history.back()})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en möblering som heter "'+t.furnituring.Name+'". Två möbleringar kan inte heta lika.'}:e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när möbleringen skulle sparas"}})}}]),angular.module("BookingSystem.mealsServices",["ngResource"]).factory("Meal",["$resource","API_URL",function(e,t){return e(t+"Meal/:mealId",{mealId:"@mealId"})}]).factory("MealHasPropertyHelper",["MealHasProperty","MealProperty",function(e,t){return{getCombined:function(r){var s=t.query(),o=e.queryForMealProperty({mealPropertyId:mealPropertyId});return s.$promise["finally"](function(){o.$promise["finally"](function(){s.forEach(function(e){var t=!1,r=void 0;for(r=0;r<o.length;r++)if(e.MealPropertyId===o[r].MealPropertyId){e.Selected=!0,t=!0;break}t||(e.Selected=!1)})})}),s}}}]),angular.module("BookingSystem.meals",[]).controller("MealsListCtrl",["$rootScope","$scope","$state","Meal",function(e,t,r,s){var o=function(){var r=s.query();r.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Måltider kunde inte hämtas, var god försök igen."}}),t.meals=r};t.$on("$ionicView.enter",function(e,t){o()})}]).controller("MealDetailsCtrl",["$rootScope","$scope","$stateParams","MODAL_ANIMATION","$ionicModal","$state","Meal","MealHasProperty",function(e,t,r,s,o,a,n,i){var u="templates/modals/meals-delete.html";t.isEditMode=!1,t.mealBackup={};var l=function(){o.fromTemplateUrl(u,{scope:t,animation:s}).then(function(e){t.modal=e}),t.$on("$destroy",function(){t.modal.remove()})},c=function(){var s=n.get({mealId:r.mealId});s.$promise.then(function(){s.mealProperties=i.queryForMealProperty({mealPropertyId:r.mealPropertyId})})["catch"](function(){e.FlashMessage={type:"error",message:"Måltid kunde inte hämtas, var god försök igen."}}),t.meal=s};t.startEditMode=function(){var e=this;e.isEditMode=!0,e.mealBackup=angular.copy(e.meal)},t.endEditMode=function(){var e=this;e.isEditMode=!1},t.abortEditMode=function(){var e=this;e.isEditMode=!1,e.meal=e.mealBackup},t.saveMeal=function(){var t=this;n.save({MealId:r.mealId,Name:t.meal.Name}).$promise.then(function(r){t.endEditMode(),e.FlashMessage={type:"success",message:'Måltiden "'+t.meal.Name+'" sparades med ett lyckat resultat'}})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en måltid som heter "'+t.meal.Name+'". Två måltider kan inte heta lika.'}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när måltiden skulle sparas"}),404===r.status&&(e.FlashMessage={type:"error",message:'Måltiden "'+t.meal.Name+'" existerar inte längre. Hann kanske någon radera den?'},history.back())})},t.deleteMeal=function(){n["delete"]({mealId:r.mealId}).$promise.then(function(r){e.FlashMessage={type:"success",message:'Måltiden "'+t.meal.Name+'" raderades med ett lyckat resultat'},history.back()})["catch"](function(r){400===r.status&&"undefined"!==r.data.Message&&"Foreign key references exists"===r.data.Message?e.FlashMessage={type:"error",message:"Måltiden kan inte raderas eftersom det finns en lokalbokning eller en lokalmåltid som refererar till måltiden"}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när måltiden skulle tas bort"}),404===r.status&&(e.FlashMessage={type:"error",message:'Måltiden "'+t.meal.Name+'" existerar inte längre. Hann kanske någon radera den?'}),history.back()})},l(),c()}]).controller("MealCreateCtrl",["$rootScope","$stateParams","$scope","$state","Meal",function(e,t,r,s,o){r.meal={},r.saveMeal=function(){var t=this;o.save({MealId:0,Name:t.meal.Name}).$promise.then(function(r){e.FlashMessage={type:"success",message:'Måltiden "'+t.meal.Name+'" skapades med ett lyckat resultat'},history.back()})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en måltid som heter "'+t.meal.Name+'". Två måltider kan inte heta lika.'}:e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när måltiden skulle sparas"}})}}]),angular.module("BookingSystem.mealPropertiesServices",["ngResource","BookingSystem.mealsServices"]).factory("MealProperty",["$resource","API_URL",function(e,t){return e(t+"MealProperty/:mealPropertyId",{mealPropertyId:"@mealPropertyId"})}]).factory("MealHasProperty",["$resource","API_URL",function(e,t){return e(t+"MealHasProperty/:mealPropertyId/:mealId",{mealPropertyId:"@mealPropertyId"},{remove:{url:t+"MealHasProperty/:mealPropertyId/:mealId",id:"@id",method:"DELETE",isArray:!1,params:{mealPropertyId:"@mealPropertyId",mealId:"@mealId"}},removeForMealProperty:{url:t+"MealHasProperty/:mealPropertyId",id:"@id",method:"DELETE",isArray:!1,params:{mealPropertyId:"@mealPropertyId"}},queryForMealProperty:{url:t+"MealHasProperty/:mealPropertyId",id:"@id",method:"GET",isArray:!0,params:{mealPropertyId:"@mealPropertyId"}},saveForMealProperty:{url:t+"MealHasProperty",id:"@id",method:"POST",isArray:!0}})}]),angular.module("BookingSystem.resourcesServices",["ngResource"]).factory("Resource",["$resource","API_URL",function(e,t){return e(t+"Resource/:resourceId",{resourceId:"@resourceId"})}]),angular.module("BookingSystem.resources",[]).controller("ResourcesListCtrl",["$rootScope","$scope","$state","Resource",function(e,t,r,s){var o=function(){var r=s.query();r.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Resurser kunde inte hämtas, var god försök igen."}}),t.resources=r};t.$on("$ionicView.enter",function(e,t){o()})}]).controller("ResourceDetailsCtrl",["$rootScope","$scope","$stateParams","MODAL_ANIMATION","$ionicModal","$state","Resource",function(e,t,r,s,o,a,n){var i="templates/modals/resources-delete.html";t.isEditMode=!1,t.resourceBackup={};var u=function(){o.fromTemplateUrl(i,{scope:t,animation:s}).then(function(e){t.modal=e}),t.$on("$destroy",function(){t.modal.remove()})},l=function(){var s=n.get({resourceId:r.resourceId});s.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Resurs kunde inte hämtas, var god försök igen."}}),t.resource=s};t.startEditMode=function(){var e=this;e.isEditMode=!0,e.resourceBackup=angular.copy(e.resource)},t.endEditMode=function(){var e=this;e.isEditMode=!1},t.abortEditMode=function(){var e=this;e.isEditMode=!1,e.resource=e.resourceBackup},t.saveResource=function(){var t=this;n.save({ResourceId:r.resourceId,Name:t.resource.Name,Count:t.resource.Count,BookingPricePerHour:t.resource.BookingPricePerHour,MinutesMarginAfterBooking:t.resource.MinutesMarginAfterBooking,WeekEndCount:t.resource.WeekEndCount}).$promise.then(function(r){t.endEditMode(),e.FlashMessage={type:"success",message:'Resursen "'+t.resource.Name+'" sparades med ett lyckat resultat'}})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en resurs som heter "'+t.resource.Name+'". Två resurser kan inte heta lika.'}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när resursen skulle sparas"}),404===r.status&&(e.FlashMessage={type:"error",message:'Resursen "'+t.resource.Name+'" existerar inte längre. Hann kanske någon radera den?'},history.back())})},t.deleteResource=function(){n["delete"]({resourceId:r.resourceId}).$promise.then(function(r){e.FlashMessage={type:"success",message:'Resursen "'+t.resource.Name+'" raderades med ett lyckat resultat'},history.back()})["catch"](function(r){400===r.status&&"undefined"!==r.data.Message&&"Foreign key references exists"===r.data.Message?e.FlashMessage={type:"error",message:"Resursen kan inte raderas eftersom det finns en lokalbokning eller en lokalresurs som refererar till resursen"}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när resursen skulle tas bort"}),404===r.status&&(e.FlashMessage={type:"error",message:'Resursen "'+t.resource.Name+'" existerar inte längre. Hann kanske någon radera den?'}),history.back()})},u(),l()}]).controller("ResourceCreateCtrl",["$rootScope","$stateParams","$scope","$state","Resource",function(e,t,r,s,o){r.resource={},r.saveResource=function(){var t=this;o.save({ResourceId:0,Name:t.resource.Name,Count:t.resource.Count,BookingPricePerHour:t.resource.BookingPricePerHour,MinutesMarginAfterBooking:t.resource.MinutesMarginAfterBooking,WeekEndCount:t.resource.WeekEndCount}).$promise.then(function(r){e.FlashMessage={type:"success",message:'Resursen "'+t.resource.Name+'" skapades med ett lyckat resultat'},history.back()})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en resurs som heter "'+t.resource.Name+'". Två resurser kan inte heta lika.'}:e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när resursen skulle sparas"}})}}]),angular.module("BookingSystem.customersServices",["ngResource"]).factory("Customer",["$resource","API_URL",function(e,t){return e(t+"Customer/:customerId",{customerId:"@customerId"})}]).factory("CustomerImage",["$http","API_URL",function(e,t){return{upload:function(r,s){return e({method:"POST",url:t+"Customer/image/"+s,data:r,headers:{"Content-Type":void 0}})}}}]),angular.module("BookingSystem.customers",[]).controller("CustomersListCtrl",["$rootScope","$scope","$state","Customer",function(e,t,r,s){var o=function(){var r=s.query();r.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Kunder kunde inte hämtas, var god försök igen."}}),t.customers=r};t.$on("$ionicView.enter",function(e,t){o()})}]).controller("CustomerDetailsCtrl",["$rootScope","$scope","$stateParams","MODAL_ANIMATION","$ionicModal","$state","Customer","CustomerImage",function(e,t,r,s,o,a,n,i){var u="templates/modals/customers-delete.html";t.isEditMode=!1,t.customerBackup={};var l=function(){o.fromTemplateUrl(u,{scope:t,animation:s}).then(function(e){t.modal=e}),t.$on("$destroy",function(){t.modal.remove()})},c=function(e){return i.upload(t.customer.ImageForUpload,e)},m=function(){e.FlashMessage={type:"success",message:'Kunden "'+t.customer.Name+'" sparades med ett lyckat resultat'},history.back()},d=function(){var s=n.get({customerId:r.customerId});s.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Kunden kunde inte hämtas, var god försök igen."}}),t.customer=s};t.startEditMode=function(){var e=this;e.isEditMode=!0,e.customerBackup=angular.copy(e.customer)},t.endEditMode=function(){var e=this;e.isEditMode=!1},t.abortEditMode=function(){var e=this;e.isEditMode=!1,e.customer=e.customerBackup},t.saveCustomer=function(){var t=this;n.save({CustomerId:r.customerId,Name:t.customer.Name,Address:t.customer.Address,PostNumber:t.customer.PostNumber,City:t.customer.City,EmailAddress:t.customer.EmailAddress,PhoneNumber:t.customer.PhoneNumber,CellPhoneNumber:t.customer.CellPhoneNumber,ParentCustomerId:t.customer.ParentCustomerId,ImageSrc:t.customer.ImageSrc,Notes:t.customer.Notes}).$promise.then(function(r){t.endEditMode(),"undefined"!=typeof t.customer.ImageForUpload?c(r.CustomerId).success(function(){m()}).error(function(){e.FlashMessage={type:"error",message:"Kunden sparades, men det gick inte att ladda upp och spara den önskade bilden."}}):m()})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en kund som heter "'+t.customer.Name+'". Två kunder kan inte heta lika.'}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när kunden skulle sparas"}),404===r.status&&(e.FlashMessage={type:"error",message:'Kunden "'+t.customer.Name+'" existerar inte längre. Hann kanske någon radera den?'},history.back())})},t.deleteCustomer=function(){n["delete"]({customerId:r.customerId}).$promise.then(function(r){e.FlashMessage={type:"success",message:'Kunden "'+t.customer.Name+'" raderades med ett lyckat resultat'},history.back()})["catch"](function(r){400===r.status&&"undefined"!==r.data.Message&&"Foreign key references exists"===r.data.Message?e.FlashMessage={type:"error",message:"Kunden kan inte raderas eftersom det finns en bokning som refererar till kunden"}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när kunden skulle tas bort"}),404===r.status&&(e.FlashMessage={type:"error",message:'Kunden "'+t.customer.Name+'" existerar inte längre. Hann kanske någon radera den?'}),history.back()})},l(),d()}]).controller("CustomerCreateCtrl",["$rootScope","$stateParams","$scope","$state","Customer","CustomerImage",function(e,t,r,s,o,a){r.customer={};var n=function(e){return a.upload(r.customer.ImageForUpload,e)},i=function(){e.FlashMessage={type:"success",message:'Kunden "'+r.customer.Name+'" sparades med ett lyckat resultat'},history.back()};r.saveCustomer=function(){var t=this;o.save({CustomerId:0,Name:t.customer.Name,Address:t.customer.Address,PostNumber:t.customer.PostNumber,City:t.customer.City,EmailAddress:t.customer.EmailAddress,PhoneNumber:t.customer.PhoneNumber,CellPhoneNumber:t.customer.CellPhoneNumber,ParentCustomerId:t.customer.ParentCustomerId,ImageSrc:t.customer.ImageSrc,Notes:t.customer.Notes}).$promise.then(function(r){"undefined"!=typeof t.customer.ImageForUpload?n(r.CustomerId).success(function(e){i()}).error(function(){e.FlashMessage={type:"error",message:'Kunden "'+t.customer.Name+'" skapades, men det gick inte att ladda upp och spara den önskade bilden.'},history.back()}):i()})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en kund som heter "'+t.customer.Name+'". Två kunder kan inte heta lika.'}:e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när kunden skulle sparas"}})}}]),angular.module("BookingSystem.bookingTypesServices",["ngResource"]).factory("BookingType",["$resource","API_URL",function(e,t){return e(t+"BookingType/:bookingTypeId",{bookingTypeId:"@bookingTypeId"})}]),angular.module("BookingSystem.bookingTypes",[]).controller("BookingTypesListCtrl",["$rootScope","$scope","$state","BookingType",function(e,t,r,s){var o=function(){var r=s.query();r.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Bokningstyper kunde inte hämtas, var god försök igen."}}),t.bookingTypes=r};t.$on("$ionicView.enter",function(e,t){o()})}]).controller("BookingTypeDetailsCtrl",["$rootScope","$scope","$stateParams","MODAL_ANIMATION","$ionicModal","$state","BookingType",function(e,t,r,s,o,a,n){var i="templates/modals/bookingtypes-delete.html";t.isEditMode=!1,t.bookingTypeBackup={};var u=function(){o.fromTemplateUrl(i,{scope:t,animation:s}).then(function(e){t.modal=e}),t.$on("$destroy",function(){t.modal.remove()})},l=function(){var s=n.get({bookingTypeId:r.bookingTypeId});s.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Bokningstypen kunde inte hämtas, var god försök igen."}}),t.bookingType=s};t.toggleHasLocation=function(){var e=this;console.log(e.bookingType.HasLocation),e.bookingType.HasLocation===!0?e.bookingType.HasLocation=!1:e.bookingType.HasLocation=!0},t.startEditMode=function(){var e=this;e.isEditMode=!0,e.bookingTypeBackup=angular.copy(e.bookingType)},t.endEditMode=function(){var e=this;e.isEditMode=!1},t.abortEditMode=function(){var e=this;e.isEditMode=!1,e.bookingType=e.bookingTypeBackup},t.saveBookingType=function(){var t=this;n.save({BookingTypeId:r.bookingTypeId,Name:t.bookingType.Name}).$promise.then(function(r){t.endEditMode(),e.FlashMessage={type:"success",message:'Bokningstypen "'+t.bookingType.Name+'" sparades med ett lyckat resultat'}})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en bokningstyp som heter "'+t.bookingType.Name+'". Två boknigstyper kan inte heta lika.'}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när bokningstypen skulle sparas"}),404===r.status&&(e.FlashMessage={type:"error",message:'Bokningstypen "'+t.bookingType.Name+'" existerar inte längre. Hann kanske någon radera den?'},history.back())})},t.deleteBookingType=function(){n["delete"]({bookingTypeId:r.bookingTypeId}).$promise.then(function(r){e.FlashMessage={type:"success",message:'Bokningstypen "'+t.bookingType.Name+'" raderades med ett lyckat resultat'},history.back()})["catch"](function(r){400===r.status&&"undefined"!==r.data.Message&&"Foreign key references exists"===r.data.Message?e.FlashMessage={type:"error",message:"Bokningstypen kan inte raderas eftersom det finns en bokning som refererar till bokningstypen"}:400!==r.status&&500!==r.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när bokningstypen skulle tas bort"}),404===r.status&&(e.FlashMessage={type:"error",message:'Bokningstypen "'+t.bookingType.Name+'" existerar inte längre. Hann kanske någon radera den?'}),history.back()})},u(),l()}]).controller("BookingTypeCreateCtrl",["$rootScope","$stateParams","$scope","$state","BookingType",function(e,t,r,s,o){r.bookingType={},r.bookingType.HasLocation=!1,r.toggleHasLocation=function(){var e=this;e.bookingType.HasLocation===!0?e.bookingType.HasLocation=!1:e.bookingType.HasLocation=!0},r.saveBookingType=function(){var t=this;o.save({BookingTypeId:0,Name:t.bookingType.Name,HasLocation:t.bookingType.HasLocation,MinutesMarginBeforeBooking:t.bookingType.MinutesMarginBeforeBooking,MinutesMarginAfterBooking:t.bookingType.MinutesMarginAfterBooking}).$promise.then(function(r){e.FlashMessage={type:"success",message:'Bokningstypen "'+t.bookingType.Name+'" skapades med ett lyckat resultat'},history.back()})["catch"](function(r){409===r.status?e.FlashMessage={type:"error",message:'Det finns redan en bokningstyp som heter "'+t.bookingType.Name+'". Två bokningstyper kan inte heta lika.'}:e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när bokningstypen skulle sparas"}})}}]),angular.module("BookingSystem.imageResizeServices",[]).factory("ImageResize",["UPLOAD_IMG_MAX_WIDTH","UPLOAD_IMG_MAX_HEIGHT","$q",function(e,t,r){var s=void 0,o=void 0,a=void 0,n=function(e){var t=document.createElement("canvas");return t.width=e.width/2,t.height=e.height/2,t.getContext("2d").drawImage(e,0,0,t.width,t.height),t},i=function(e,t,r){function s(e,t,r,s,o,a){var n=1-o,i=1-a;return e*n*i+t*o*i+r*n*a+s*o*a}var o=void 0,a=void 0,n=void 0,i=void 0,u=void 0,l=void 0,c=void 0,m=void 0,d=void 0,g=void 0,p=void 0,y=void 0,f=void 0,k=void 0,h=void 0,M=void 0,v=void 0,I=void 0,b=void 0;for(o=0;o<t.height;++o)for(n=o/r,i=Math.floor(n),u=Math.ceil(n)>e.height-1?e.height-1:Math.ceil(n),a=0;a<t.width;++a)l=a/r,c=Math.floor(l),m=Math.ceil(l)>e.width-1?e.width-1:Math.ceil(l),d=4*(a+t.width*o),g=4*(c+e.width*i),p=4*(m+e.width*i),y=4*(c+e.width*u),f=4*(m+e.width*u),k=l-c,h=n-i,M=s(e.data[g],e.data[p],e.data[y],e.data[f],k,h),t.data[d]=M,v=s(e.data[g+1],e.data[p+1],e.data[y+1],e.data[f+1],k,h),t.data[d+1]=v,I=s(e.data[g+2],e.data[p+2],e.data[y+2],e.data[f+2],k,h),t.data[d+2]=I,b=s(e.data[g+3],e.data[p+3],e.data[y+3],e.data[f+3],k,h),t.data[d+3]=b},u=function(t){var r=document.createElement("canvas"),s=e/t.width;r.width=t.width*s,r.height=t.height*s;var o=t.getContext("2d").getImageData(0,0,t.width,t.height),a=r.getContext("2d").createImageData(r.width,r.height);return i(o,a,s),r.getContext("2d").putImageData(a,0,0),r};return{scaleImage:function(t){return s=document.createElement("img"),o=document.createElement("canvas"),a=r.defer(),s.src=t,s.onload=function(){for(o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0,o.width,o.height);o.width>=2*e;)o=n(o);o.width>e&&(o=u(o)),returnImageData=o.toDataURL("image/jpeg",1),a.resolve(returnImageData)},a.promise}}}]);