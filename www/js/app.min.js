"use strict";var BookingSystem=angular.module("BookingSystem",["ionic","BookingSystem.controllers","BookingSystem.furnituring","BookingSystem.furnituringServices","BookingSystem.meals","BookingSystem.mealsServices","BookingSystem.resources","BookingSystem.resourcesServices","ngMaterial","ngResource"]);BookingSystem.run(["$ionicPlatform",function(e){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]),BookingSystem.constant("API_URL","http://www.pesola.se:8080/BookingSystem/api/"),BookingSystem.constant("DEFAULT_MAP_ZOOM",5),BookingSystem.constant("DEFAULT_LATITUDE",59.2792),BookingSystem.constant("DEFAULT_LONGITUDE",15.2361),BookingSystem.constant("MODAL_ANIMATION","slide-in-up"),BookingSystem.config(["$stateProvider","$urlRouterProvider",function(e,r){e.state("app",{url:"/app","abstract":!0,templateUrl:"templates/menu.html",controller:"AppCtrl"}).state("app.start",{url:"/start",views:{menuContent:{templateUrl:"templates/start.html"}}}).state("app.furnituring-list",{url:"/furnituring-list",views:{menuContent:{templateUrl:"templates/furnituring/furnituring-list.html",controller:"FurnituringListCtrl"}}}).state("app.furnituring-details",{url:"/furnituring-details/:furnituringId",views:{menuContent:{templateUrl:"templates/furnituring/furnituring-details.html",controller:"FurnituringDetailsCtrl"}}}).state("app.furnituring-create",{url:"/furnituring-create",views:{menuContent:{templateUrl:"templates/furnituring/furnituring-create.html",controller:"FurnituringCreateCtrl"}}}).state("app.meals-list",{url:"/meals-list",views:{menuContent:{templateUrl:"templates/meals/meals-list.html",controller:"MealsListCtrl"}}}).state("app.resources-list",{url:"/resources-list",views:{menuContent:{templateUrl:"templates/resources/resources-list.html",controller:"ResourcesListCtrl"}}}).state("app.resource-details",{url:"/resource-details/:resourceId",views:{menuContent:{templateUrl:"templates/resources/resource-details.html",controller:"ResourceDetailsCtrl"}}}).state("app.resource-create",{url:"/resource-create",views:{menuContent:{templateUrl:"templates/resources/resource-create.html",controller:"ResourceCreateCtrl"}}}),r.otherwise("/app/start")}]),angular.module("BookingSystem.furnituringServices",["ngResource"]).factory("Furnituring",["$resource","API_URL",function(e,r){return e(r+"Furnituring/:furnituringId",{furnituringId:"@furnituringId"})}]).factory("LocationFurnituring",["$resource","API_URL",function(e,r){return e(r+"LocationFurnituring/:locationId",{locationId:"@locationId"},{remove:{url:r+"LocationFurnituring/:locationId/:furnituringId",id:"@id",method:"DELETE",isArray:!1,params:{locationId:"@locationId",furnituringId:"@furnituringId"}},removeForLocation:{url:r+"LocationFurnituring/:locationId",id:"@id",method:"DELETE",isArray:!1,params:{locationId:"@locationId"}},queryForLocation:{url:r+"LocationFurnituring/location/:locationId",id:"@id",method:"GET",isArray:!0,params:{locationId:"@locationId"}},saveForLocation:{url:r+"LocationFurnituring/location",id:"@id",method:"POST",isArray:!0}})}]),angular.module("BookingSystem.controllers",[]).controller("AppCtrl",["$scope","$ionicModal","$timeout",function(e,r,t){e.loginData={},r.fromTemplateUrl("templates/login.html",{scope:e}).then(function(r){e.modal=r}),e.closeLogin=function(){e.modal.hide()},e.login=function(){e.modal.show()},e.doLogin=function(){console.log("Doing login",e.loginData),t(function(){e.closeLogin()},1e3)}}]).controller("PlaylistsCtrl",["$scope",function(e){e.playlists=[{title:"Reggae",id:1},{title:"Chill",id:2},{title:"Dubstep",id:3},{title:"Indie",id:4},{title:"Rap",id:5},{title:"Cowbell",id:6}]}]).controller("PlaylistCtrl",["$scope","$stateParams",function(e,r){}]),angular.module("BookingSystem.furnituring",[]).controller("FurnituringListCtrl",["$rootScope","$scope","$state","Furnituring",function(e,r,t,s){var n=function(){var t=s.query();t.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Möbleringar kunde inte hämtas, var god försök igen."}}),r.furniturings=t};r.$on("$ionicView.enter",function(e,r){n()})}]).controller("FurnituringDetailsCtrl",["$rootScope","$scope","$stateParams","MODAL_ANIMATION","$state","$ionicModal","Furnituring",function(e,r,t,s,n,o,a){var i="templates/modals/furnituring-delete.html";r.editMode=!1,r.furnituringBackup={};var u=function(){o.fromTemplateUrl(i,{scope:r,animation:s}).then(function(e){r.modal=e}),r.$on("$destroy",function(){r.modal.remove()})},l=function(){var s=a.get({furnituringId:t.furnituringId});s.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Möblering kunde inte hämtas, var god försök igen."}}),r.furnituring=s};r.startEditMode=function(){var e=this;e.isEditMode=!0,e.furnituringBackup=angular.copy(e.furnituring)},r.endEditMode=function(){var e=this;e.isEditMode=!1},r.abortEditMode=function(){var e=this;e.isEditMode=!1,e.furnituring=e.furnituringBackup},r.saveFurnituring=function(){var r=this;a.save({FurnituringId:t.furnituringId,Name:r.furnituring.Name}).$promise.then(function(t){r.endEditMode(),e.FlashMessage={type:"success",message:'Möbleringen "'+r.furnituring.Name+'" sparades med ett lyckat resultat'}})["catch"](function(t){409===t.status?e.FlashMessage={type:"error",message:'Det finns redan en möblering som heter "'+r.furnituring.Name+'". Två möbleringar kan inte heta lika.'}:400!==t.status&&500!==t.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när möbleringen skulle sparas"}),404===t.status&&(e.FlashMessage={type:"error",message:'Möbleringen "'+r.furnituring.Name+'" existerar inte längre. Hann kanske någon radera den?'},history.back())})},r.deleteFurnituring=function(){a["delete"]({furnituringId:t.furnituringId}).$promise.then(function(t){e.FlashMessage={type:"success",message:'Möbleringen "'+r.furnituring.Name+'" raderades med ett lyckat resultat'},history.back()})["catch"](function(t){400===t.status&&"undefined"!==t.data.Message&&"Foreign key references exists"===t.data.Message?e.FlashMessage={type:"error",message:"Möbleringen kan inte raderas eftersom det finns en lokalbokning eller en lokalmöblering som refererar till möbleringen"}:400!==t.status&&500!==t.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när möbleringen skulle tas bort"}),404===t.status&&(e.FlashMessage={type:"error",message:'Möbleringen "'+r.furnituring.Name+'" existerar inte längre. Hann kanske någon radera den?'}),history.back()})},u(),l()}]).controller("FurnituringCreateCtrl",["$rootScope","$stateParams","$scope","$state","Furnituring",function(e,r,t,s,n){t.furnituring={},t.saveFurnituring=function(){var r=this;n.save({FurnituringId:0,Name:r.furnituring.Name}).$promise.then(function(t){e.FlashMessage={type:"success",message:'Möbleringen "'+r.furnituring.Name+'" skapades med ett lyckat resultat'},history.back()})["catch"](function(t){409===t.status?e.FlashMessage={type:"error",message:'Det finns redan en möblering som heter "'+r.furnituring.Name+'". Två möbleringar kan inte heta lika.'}:e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när möbleringen skulle sparas"}})}}]),angular.module("BookingSystem.mealsServices",["ngResource"]).factory("Meal",["$resource","API_URL",function(e,r){return e(r+"Meal/:mealId",{mealsId:"@mealId"})}]),angular.module("BookingSystem.meals",[]).controller("MealsListCtrl",["$rootScope","$scope","$state","Meal",function(e,r,t,s){var n=function(){var t=s.query();t.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Måltider kunde inte hämtas, var god försök igen."}}),r.meals=t};n()}]),angular.module("BookingSystem.resourcesServices",["ngResource"]).factory("Resource",["$resource","API_URL",function(e,r){return e(r+"Resource/:resourceId",{resourceId:"@resourceId"})}]).factory("ResourceImage",["$http","API_URL",function(e,r){return{upload:function(t,s){return e({method:"POST",url:r+"Customer/image/"+customerId,data:t,headers:{"Content-Type":void 0}})}}}]),angular.module("BookingSystem.resources",[]).controller("ResourcesListCtrl",["$rootScope","$scope","$state","$mdToast","Resource",function(e,r,t,s,n){var o=function(){var e=n.query();e.$promise["catch"](function(){s.show(s.simple().content("Resurser kunde inte hämtas, var god försök igen.").position("top right"))}),r.resources=e};r.$on("$ionicView.enter",function(e,r){o()})}]).controller("ResourceDetailsCtrl",["$rootScope","$scope","$stateParams","MODAL_ANIMATION","$ionicModal","$state","Resource","ResourceImage",function(e,r,t,s,n,o,a,i){var u="templates/modals/resources-delete.html";r.isEditMode=!1,r.resourceBackup={};var l=function(){n.fromTemplateUrl(u,{scope:r,animation:s}).then(function(e){r.modal=e}),r.$on("$destroy",function(){r.modal.remove()})},c=function(e){return i.upload(r.resource.ImageForUpload,e)},g=function(){e.FlashMessage={type:"success",message:'Resursen "'+r.resource.Name+'" sparades med ett lyckat resultat'},history.back()},d=function(){var s=a.get({resourceId:t.resourceId});s.$promise["catch"](function(){e.FlashMessage={type:"error",message:"Resurs kunde inte hämtas, var god försök igen."}}),r.resource=s};r.startEditMode=function(){var e=this;e.isEditMode=!0,e.resourceBackup=angular.copy(e.resource)},r.endEditMode=function(){var e=this;e.isEditMode=!1},r.abortEditMode=function(){var e=this;e.isEditMode=!1,e.resource=e.resourceBackup},r.saveResource=function(){var r=this;a.save({ResourceId:t.resourceId,Name:r.resource.Name,Count:r.resource.Count,BookingPricePerHour:r.resource.BookingPricePerHour,MinutesMarginAfterBooking:r.resource.MinutesMarginAfterBooking,WeekEndCount:r.resource.WeekEndCount}).$promise.then(function(t){r.endEditMode(),"undefined"!=typeof r.resource.ImageForUpload?c(t.ResourceId).success(function(){g()}).error(function(){e.FlashMessage={type:"error",message:"Resursen sparades, men det gick inte att ladda upp och spara den önskade bilden."}}):g()})["catch"](function(t){409===t.status?e.FlashMessage={type:"error",message:'Det finns redan en resurs som heter "'+r.resource.Name+'". Två resurser kan inte heta lika.'}:400!==t.status&&500!==t.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när resursen skulle sparas"}),404===t.status&&(e.FlashMessage={type:"error",message:'Resursen "'+r.resource.Name+'" existerar inte längre. Hann kanske någon radera den?'},history.back())})},r.deleteResource=function(){a["delete"]({resourceId:t.resourceId}).$promise.then(function(t){e.FlashMessage={type:"success",message:'Resursen "'+r.resource.Name+'" raderades med ett lyckat resultat'},history.back()})["catch"](function(t){400===t.status&&"undefined"!==t.data.Message&&"Foreign key references exists"===t.data.Message?e.FlashMessage={type:"error",message:"Resursen kan inte raderas eftersom det finns en lokalbokning eller en lokalresurs som refererar till resursen"}:400!==t.status&&500!==t.status||(e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när resursen skulle tas bort"}),404===t.status&&(e.FlashMessage={type:"error",message:'Resursen "'+r.resource.Name+'" existerar inte längre. Hann kanske någon radera den?'}),history.back()})},l(),d()}]).controller("ResourceCreateCtrl",["$rootScope","$stateParams","$scope","$state","Resource",function(e,r,t,s,n){t.resource={},t.saveResource=function(){var r=this;n.save({ResourceId:0,Name:r.resource.Name,Count:r.resource.Count,BookingPricePerHour:r.resource.BookingPricePerHour,MinutesMarginAfterBooking:r.resource.MinutesMarginAfterBooking,WeekEndCount:r.resource.WeekEndCount}).$promise.then(function(t){e.FlashMessage={type:"success",message:'Resursen "'+r.resource.Name+'" skapades med ett lyckat resultat'},history.back()})["catch"](function(t){409===t.status?e.FlashMessage={type:"error",message:'Det finns redan en resurs som heter "'+r.resource.Name+'". Två resurser kan inte heta lika.'}:e.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när resursen skulle sparas"}})}}]);